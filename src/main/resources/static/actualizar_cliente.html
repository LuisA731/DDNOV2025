<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Actualizar Cliente - AmeriBank</title>
    <link rel="stylesheet" href="/css/styles1.css">
    <script>
        async function cargarClientes() {
            try {
                const res = await fetch('/api/clientes/todos');
                const clientes = await res.json();
                const tabla = document.getElementById('tablaClientes');
                tabla.innerHTML = '';

                clientes.forEach(c => {
                    const fila = document.createElement('tr');
                    fila.innerHTML = `
                        <td>${c.clienteId}</td>
                        <td>${c.numeroCliente}</td>
                        <td>${c.nombre}</td>
                        <td>${c.apellidoPat} ${c.apellidoMat || ''}</td>
                        <td>
                            <button class="btn-editar" onclick='llenarFormulario(${JSON.stringify(c).replace(/'/g, "&#39;")})'>
                                 Editar
                            </button>
                        </td>
                    `;
                    tabla.appendChild(fila);
                });
            } catch (error) {
                console.error('Error al cargar clientes:', error);
                mostrarMensaje('Error al cargar la lista de clientes', 'error');
            }
        }

        function llenarFormulario(c) {
            document.getElementById('clienteId').value = c.clienteId;
            document.getElementById('numeroCliente').value = c.numeroCliente;
            document.getElementById('nombre').value = c.nombre;
            document.getElementById('apellidoPat').value = c.apellidoPat;
            document.getElementById('apellidoMat').value = c.apellidoMat || '';
            document.getElementById('fechaNac').value = c.fechaNac;
            document.getElementById('rfc').value = c.rfc;
            document.getElementById('curp').value = c.curp;
            document.getElementById('email').value = c.email;
            document.getElementById('celular').value = c.celular;
            document.getElementById('direccion').value = c.direccion || '';
            document.getElementById('ciudad').value = c.ciudad || '';
            document.getElementById('estado').value = c.estado || '';
            document.getElementById('cp').value = c.cp || '';
            document.getElementById('estatus').value = c.estatus;

            // Scroll al formulario
            document.getElementById('formularioSection').scrollIntoView({
                behavior: 'smooth'
            });

            mostrarMensaje(`Cliente ${c.nombre} seleccionado para editar`, 'success');
        }

        function mostrarMensaje(mensaje, tipo) {
            const div = document.getElementById('mensaje');
            div.textContent = mensaje;
            div.className = `mensaje ${tipo}`;
            div.style.display = 'block';

            setTimeout(() => {
                div.style.display = 'none';
            }, 5000);
        }

        window.onload = cargarClientes;
    </script>
</head>
<body>
<div class="container">
    <div class="header">
        <h1> AmeriBank</h1>
        <p>Gesti贸n de Clientes - Actualizaci贸n</p>
    </div>

    <div class="content-section">
        <div class="section-header">
            <h2> Lista de Clientes</h2>
            <p>Seleccione un cliente para editar su informaci贸n</p>
        </div>

        <div class="table-container">
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>N煤mero Cliente</th>
                    <th>Nombre</th>
                    <th>Apellidos</th>
                    <th>Acci贸n</th>
                </tr>
                </thead>
                <tbody id="tablaClientes">
                <tr>
                    <td colspan="5" style="text-align: center; padding: 20px;">
                        Cargando clientes...
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="content-section" id="formularioSection">
        <div class="section-header">
            <h2> Formulario de Actualizaci贸n</h2>
            <p>Modifique la informaci贸n del cliente seleccionado</p>
        </div>

        <div id="mensaje" class="mensaje" style="display: none;"></div>

        <form action="/api/clientes/actualizar" method="post" class="form-container">
            <div class="form-group">
                <label for="clienteId">ID del Cliente</label>
                <input type="text" id="clienteId" name="clienteId" readonly class="readonly">
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="numeroCliente">N煤mero de Cliente *</label>
                    <input type="text" id="numeroCliente" name="numeroCliente" required>
                </div>
                <div class="form-group">
                    <label for="estatus">Estatus *</label>
                    <select id="estatus" name="estatus" required>
                        <option value="">Seleccione estatus</option>
                        <option value="ACTIVO">ACTIVO</option>
                        <option value="SUSPENDIDO">SUSPENDIDO</option>
                        <option value="BLOQUEADO">BLOQUEADO</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="nombre">Nombre *</label>
                    <input type="text" id="nombre" name="nombre" required>
                </div>
                <div class="form-group">
                    <label for="apellidoPat">Apellido Paterno *</label>
                    <input type="text" id="apellidoPat" name="apellidoPat" required>
                </div>
                <div class="form-group">
                    <label for="apellidoMat">Apellido Materno</label>
                    <input type="text" id="apellidoMat" name="apellidoMat">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="fechaNac">Fecha de Nacimiento *</label>
                    <input type="date" id="fechaNac" name="fechaNac" required>
                </div>
                <div class="form-group">
                    <label for="celular">Celular *</label>
                    <input type="tel" id="celular" name="celular" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="rfc">RFC *</label>
                    <input type="text" id="rfc" name="rfc" required>
                </div>
                <div class="form-group">
                    <label for="curp">CURP *</label>
                    <input type="text" id="curp" name="curp" required>
                </div>
            </div>

            <div class="form-group">
                <label for="email">Correo Electr贸nico *</label>
                <input type="email" id="email" name="email" required>
            </div>

            <div class="form-group">
                <label for="direccion">Direcci贸n</label>
                <textarea id="direccion" name="direccion" rows="3"></textarea>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="ciudad">Ciudad</label>
                    <input type="text" id="ciudad" name="ciudad">
                </div>
                <div class="form-group">
                    <label for="estado">Estado</label>
                    <input type="text" id="estado" name="estado">
                </div>
                <div class="form-group">
                    <label for="cp">C贸digo Postal</label>
                    <input type="text" id="cp" name="cp">
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                     Actualizar Cliente
                </button>
                <a href="/registro_cliente.html" class="btn btn-secondary">
                     Registrar Nuevo Cliente
                </a>
            </div>
        </form>
    </div>
</div>
</body>
</html>

